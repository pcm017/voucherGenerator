<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tomorrow's Weather</title>
</head>
<body>
    <h1>Tomorrow's Weather</h1>
    
    <button id="detect-weather">Detect Weather</button>

    <p id="city">City: Loading...</p>
    <p id="weather">Tomorrow's Weather: Loading...</p>
    <p id="sunrise">Sunrise 🌅: Loading...</p>
    <p id="sunset">Sunset 🌇: Loading...</p>
    <p id="tomorrow-date">Tomorrow's Date 📅: Loading...</p>
    <p id="temperature">Temperature 🌡️: Loading...</p>

    <script>
        // Replace 'YOUR_API_KEY' with your actual OpenWeatherMap API key
        const apiKey = '367ae43a55b3c1b1d61afce3c7d7af59';

        // Function to get the user's city using the Geolocation API
        function getCity() {
            if ('geolocation' in navigator) {
                navigator.geolocation.getCurrentPosition((position) => {
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;
                    fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${apiKey}`)
                        .then((response) => response.json())
                        .then((data) => {
                            const city = data.name;
                            document.getElementById('city').textContent = `City: ${city}`;
                            console.log('Detected City:', city);
                            getTomorrowWeather(city);
                            displaySunriseSunset(data.sys.sunrise, data.sys.sunset);
                        })
                        .catch((error) => {
                            console.error('Error fetching city:', error);
                        });
                });
            } else {
                console.error('Geolocation is not available.');
            }
        }

        // Function to get tomorrow's weather for the given city
        function getTomorrowWeather(city) {
            fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}`)
                .then((response) => response.json())
                .then((data) => {
                    // Find the weather data for tomorrow
                    const tomorrow = new Date();
                    tomorrow.setDate(tomorrow.getDate() + 1);
                    tomorrow.setHours(0, 0, 0, 0);

                    const weatherList = data.list;
                    for (const weather of weatherList) {
                        const dateTime = new Date(weather.dt * 1000);
                        if (dateTime.getTime() === tomorrow.getTime()) {
                            const weatherDescription = weather.weather[0].description;
                            document.getElementById('weather').textContent = `Tomorrow's Weather: ${weatherDescription}`;
                            console.log('Tomorrow\'s Weather:', weatherDescription);
                            break;
                        }
                    }
                })
                .catch((error) => {
                    console.error('Error fetching weather:', error);
                });
        }

        // Function to display sunrise and sunset times with emoji icons
        function displaySunriseSunset(sunriseTimestamp, sunsetTimestamp) {
            const sunriseTime = new Date(sunriseTimestamp * 1000);
            const sunsetTime = new Date(sunsetTimestamp * 1000);

            const sunriseFormatted = sunriseTime.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true });
            const sunsetFormatted = sunsetTime.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true });

            document.getElementById('sunrise').textContent = `Sunrise 🌅: ${sunriseFormatted}`;
            document.getElementById('sunset').textContent = `Sunset 🌇: ${sunsetFormatted}`;
        }

        // Function to calculate tomorrow's date and display temperature
        function displayTomorrowDateTemperature(data) {
            const tomorrowDate = new Date();
            tomorrowDate.setDate(tomorrowDate.getDate() + 1);
            const tomorrowFormatted = tomorrowDate.toLocaleDateString('en-US', { day: '2-digit', month: '2-digit', year: 'numeric' });

            const tomorrowTemperature = data.list[0].main.temp;
            document.getElementById('tomorrow-date').textContent = `Tomorrow's Date 📅: ${tomorrowFormatted}`;
            document.getElementById('temperature').textContent = `Temperature 🌡️: ${tomorrowTemperature}°C`;
        }

        // Event listener for the "Detect Weather" button
        document.getElementById('detect-weather').addEventListener('click', getCity);

        // Automatically detect weather when the page loads
        window.addEventListener('load', getCity);
    </script>
</body>
</html>
